DEPENDENCIES_PATH = [ SHELL "python3 -m ci_tacklebox.ci.properties dependencies_path" : strip-eol ] ;

path-constant OKUI_TEST_RESOURCES_PATH : ./resources ;

alias okui-tests-common :
    [ glob-tree-ex src : *.cpp : android.cpp ]
    ..//okui
    $(DEPENDENCIES_PATH)/gtest//gtest/<link>static
: : :
    <define>OKUI_TEST_RESOURCES_PATH=\\\"$(OKUI_TEST_RESOURCES_PATH)\\\"
;

lib okui-gtests : okui-tests-common :
    <conditional>@unit-test-library
    <link>static
;

exe okui-tests :
    okui-tests-common/<link>static
    $(DEPENDENCIES_PATH)/gtest//gtest_main/<link>static
:
    <conditional>@unit-test-executable
    <build>no
    <target-os>darwin:<build>yes
    <target-os>darwin:<framework>CoreVideo
;

lib okui-tests-android :
    okui-tests-common/<link>static
    src/android.cpp
    ../../jshackle//jshackle
:
    <link>shared
    <build>no
    <target-os>android:<build>yes
;

install dist/android : okui-tests-android :
    <build>no
    <target-os>android:<build>yes
;
